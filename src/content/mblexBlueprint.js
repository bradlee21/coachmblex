export const mblexBlueprint = {
  version: '2023',
  sections: [
    {
      code: '1',
      codePrefix: '1',
      title: 'Anatomy & Physiology',
      children: [
        {
          code: '1.A',
          title: 'System structure',
          children: [
            { code: '1.A.1', title: 'Cardiovascular' },
            { code: '1.A.2', title: 'Digestive' },
            { code: '1.A.3', title: 'Endocrine' },
            { code: '1.A.4', title: 'Integumentary' },
            { code: '1.A.5', title: 'Lymphatic & Immune' },
            { code: '1.A.6', title: 'Musculoskeletal' },
            { code: '1.A.7', title: 'Nervous' },
            { code: '1.A.8', title: 'Reproduction' },
            { code: '1.A.9', title: 'Respiratory' },
            { code: '1.A.10', title: 'Sensory' },
            { code: '1.A.11', title: 'Urinary' },
          ],
        },
        {
          code: '1.B',
          title: 'System function',
          children: [
            { code: '1.B.1', title: 'Cardiovascular' },
            { code: '1.B.2', title: 'Digestion' },
            { code: '1.B.3', title: 'Endocrine' },
            { code: '1.B.4', title: 'Integumentary' },
            { code: '1.B.5', title: 'Lymphatic & Immune' },
            { code: '1.B.6', title: 'Musculoskeletal' },
            { code: '1.B.7', title: 'Nervous' },
            { code: '1.B.8', title: 'Reproduction' },
            { code: '1.B.9', title: 'Respiratory' },
            { code: '1.B.10', title: 'Sensory' },
            { code: '1.B.11', title: 'Urinary' },
          ],
        },
        { code: '1.C', title: 'Tissue injury and repair' },
        { code: '1.D', title: 'Concepts of energetic anatomy' },
      ],
    },
    {
      code: '2',
      codePrefix: '2',
      title: 'Kinesiology',
      children: [
        { code: '2.A', title: 'Skeletal muscle components & characteristics' },
        { code: '2.B', title: 'Concepts of skeletal muscle contractions' },
        { code: '2.C', title: 'Proprioceptors' },
        {
          code: '2.D',
          title:
            'Skeletal muscle locations, attachments (origins, insertions), & actions',
        },
        { code: '2.E', title: 'Joint structure and function' },
        {
          code: '2.F',
          title: 'Range of motion',
          children: [
            { code: '2.F.1', title: 'Active' },
            { code: '2.F.2', title: 'Passive' },
            { code: '2.F.3', title: 'Resisted' },
          ],
        },
      ],
    },
    {
      code: '3',
      codePrefix: '3',
      title: 'Pathology, Contraindications, Areas of Caution, Special Populations',
      children: [
        { code: '3.A', title: 'Overview of Pathologies' },
        {
          code: '3.B',
          title: 'Contraindications',
          children: [
            { code: '3.B.1', title: 'Site specific' },
            { code: '3.B.2', title: 'Pathology related' },
            { code: '3.B.3', title: 'Special populations' },
            { code: '3.B.4', title: 'Tools' },
            { code: '3.B.5', title: 'Special applications' },
          ],
        },
        { code: '3.C', title: 'Areas of caution' },
        { code: '3.D', title: 'Special populations' },
        { code: '3.E', title: 'Classes of medications' },
      ],
    },
    {
      code: '4',
      codePrefix: '4',
      title: 'Benefits and Effects of Soft Tissue Manipulation',
      children: [
        { code: '4.A', title: 'Physiological effects of soft tissue manipulation' },
        { code: '4.B', title: 'Psychological effects of soft tissue manipulation' },
        {
          code: '4.C',
          title: 'Effects of soft tissue manipulation for specific client populations',
        },
        {
          code: '4.D',
          title: 'Soft tissue techniques',
          children: [
            { code: '4.D.1', title: 'Types of strokes' },
            { code: '4.D.2', title: 'Sequence of application' },
          ],
        },
        { code: '4.E', title: 'Hot/cold applications' },
        { code: '4.F', title: 'Overview of massage/bodywork modalities' },
      ],
    },
    {
      code: '5',
      codePrefix: '5',
      title: 'Client Assessment, Reassessment & Treatment Planning',
      children: [
        { code: '5.A', title: 'Organization of a massage/bodywork session' },
        {
          code: '5.B',
          title: 'Client consultation and evaluation',
          children: [
            { code: '5.B.1', title: 'Verbal intake' },
            { code: '5.B.2', title: 'Health history form' },
          ],
        },
        { code: '5.C', title: 'Written data collection' },
        {
          code: '5.D',
          title: 'Visual assessment',
          children: [
            { code: '5.D.1', title: 'General' },
            { code: '5.D.2', title: 'Postural' },
            { code: '5.D.3', title: 'Gait' },
          ],
        },
        { code: '5.E', title: 'Palpation assessment' },
        { code: '5.F', title: 'Range of motion assessment' },
        {
          code: '5.G',
          title: 'Clinical reasoning',
          children: [
            { code: '5.G.1', title: 'Ability to rule out contraindications' },
            { code: '5.G.2', title: 'Client treatment goal setting' },
            {
              code: '5.G.3',
              title: 'Evaluation of response to previous treatment',
            },
            { code: '5.G.4', title: 'Formulation of treatment strategy' },
          ],
        },
      ],
    },
    {
      code: '6',
      codePrefix: '6',
      title: 'Ethics, Boundaries, Laws, Regulations',
      children: [
        { code: '6.A', title: 'Ethical behavior' },
        { code: '6.B', title: 'Professional boundaries' },
        { code: '6.C', title: 'Code of ethics violations' },
        { code: '6.D', title: 'The therapeutic relationship' },
        { code: '6.E', title: 'Dual relationships' },
        { code: '6.F', title: 'Sexual misconduct' },
        { code: '6.G', title: 'Massage/bodywork-related laws and regulations' },
        { code: '6.H', title: 'Scope of practice' },
        { code: '6.I', title: 'Professional communication' },
        { code: '6.J', title: 'Confidentiality' },
        { code: '6.K', title: 'Principles' },
      ],
    },
    {
      code: '7',
      codePrefix: '7',
      title: 'Guidelines for Professional Practice',
      children: [
        { code: '7.A', title: 'Proper and safe use of equipment and supplies' },
        { code: '7.B', title: 'Practitioner hygiene' },
        { code: '7.C', title: 'Sanitation and cleanliness' },
        {
          code: '7.D',
          title: 'Safety practices',
          children: [
            { code: '7.D.1', title: 'Facilities' },
            { code: '7.D.2', title: 'Practitioner safety' },
            { code: '7.D.3', title: 'Client safety' },
          ],
        },
        {
          code: '7.E',
          title: 'Practitioner care',
          children: [
            { code: '7.E.1', title: 'Body mechanics' },
            { code: '7.E.2', title: 'Personal protective equipment (PPE)' },
            { code: '7.E.3', title: 'Self-care' },
            { code: '7.E.4', title: 'Injury prevention' },
          ],
        },
        {
          code: '7.F',
          title: 'Draping',
          children: [
            { code: '7.F.1', title: 'Safe and appropriate' },
            { code: '7.F.2', title: 'Communication' },
          ],
        },
        {
          code: '7.G',
          title: 'Business Practices',
          children: [
            { code: '7.G.1', title: 'Business planning' },
            { code: '7.G.2', title: 'Strategic planning' },
            { code: '7.G.3', title: 'Office management' },
            { code: '7.G.4', title: 'Marketing' },
            { code: '7.G.5', title: 'Hiring/Interviewing' },
            {
              code: '7.G.6',
              title: 'Documentation & Records',
              children: [
                { code: '7.G.6.a', title: 'Client records' },
                { code: '7.G.6.b', title: 'Business records' },
              ],
            },
          ],
        },
        { code: '7.H', title: 'Healthcare and business terminology' },
      ],
    },
  ],
};

function flattenNodes(nodes, parentCode = null, acc = []) {
  for (const node of nodes) {
    acc.push({
      id: node.code,
      code: node.code,
      title: node.title,
      parentCode,
    });
    if (node.children?.length) {
      flattenNodes(node.children, node.code, acc);
    }
  }
  return acc;
}

export function listTopLevelDomains() {
  return mblexBlueprint.sections.map((section) => ({
    id: section.code,
    code: section.code,
    title: section.title,
  }));
}

export function listAllNodesFlat() {
  return flattenNodes(mblexBlueprint.sections);
}

export function findNodeByCode(code) {
  return listAllNodesFlat().find((node) => node.code === code) || null;
}
